<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>0011-darwinia-cross-chain-nft-design-and-standards | Darwinia Improvement Proposals</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="0011-darwinia-cross-chain-nft-design-and-standards" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Request for comments and improvement proposals" />
<meta property="og:description" content="Request for comments and improvement proposals" />
<link rel="canonical" href="https://rfcs.darwinia.network/RFC/zh_CN/0011-darwinia-cross-chain-nft-design-and-standards" />
<meta property="og:url" content="https://rfcs.darwinia.network/RFC/zh_CN/0011-darwinia-cross-chain-nft-design-and-standards" />
<meta property="og:site_name" content="Darwinia Improvement Proposals" />
<script type="application/ld+json">
{"description":"Request for comments and improvement proposals","@type":"WebPage","url":"https://rfcs.darwinia.network/RFC/zh_CN/0011-darwinia-cross-chain-nft-design-and-standards","headline":"0011-darwinia-cross-chain-nft-design-and-standards","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://rfcs.darwinia.network/feed.xml" title="Darwinia Improvement Proposals" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Darwinia Improvement Proposals</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/all">All</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="home">
    <h1 id="cross-chain-nft-design-and-standards">Cross-chain NFT Design and Standards</h1>

<h2 id="i-cross-chain-nft-design想要解决的问题">I. Cross-chain NFT Design想要解决的问题</h2>

<p>在设计Bridge Core内的NFT流转逻辑时，我们想解决以下三个问题：</p>

<ul>
  <li>保留NFT的跨链流转路径/历史，不损失NFT的可识别性；</li>
  <li>计算和验证解耦，拥有更高的处理速度；</li>
  <li>实现额外功能，例如NFT在跨链的同时完成分解、合并等操作；</li>
</ul>

<p>为此，我们选择使用扩展的UTXO模型作为存储/状态 的流转单元，在这里我们称它为UNFO (Unspent Non-Fungible token Output).</p>

<h2 id="ii-unfo-design">II. UNFO Design</h2>

<p>我们将UNFO设计成更加通用的UTXO，其结构如下：</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">pub</span> <span class="k">struct</span> <span class="n">UNFO</span> <span class="p">{</span>
    <span class="k">pub</span> <span class="k">type</span><span class="p">:</span> <span class="n">chainId</span><span class="p">,</span>
    <span class="k">pub</span> <span class="n">value</span><span class="p">:</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">u8</span><span class="o">&gt;</span><span class="p">,</span> <span class="c">// token id on chainId</span>
    <span class="k">pub</span> <span class="n">lock</span><span class="p">:</span> <span class="n">Script</span><span class="p">,</span> <span class="c">// owner address</span>
    <span class="k">pub</span> <span class="n">cond_script</span><span class="p">:</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="n">Script</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p>在UNFO里，会标识进入Bridge Core之前，原生NFT的chainId和token id, 分别放在 type 和 value 里；lock表达的是这个NFT的所有者是谁，即使得lock脚本执行成功的人；而cond_script里放着UNFO转换的一些条件限制，例如某个NFT在同一个chainID上不允许有两个不同的token id， 可以理解成智能合约。</p>

<p>这样，当一个UNFO的销毁，意味着另一个UNFO的创建，如果我们追溯UNFO的销毁创造历史，就可以回溯某个NFT的全部跨链历史，这一定程度上帮助实现了NFT的可识别性；</p>

<p>每个UNFO只能被销毁一次，这使得计算前不一定要先验证，从而提高了处理速度；</p>

<p>正如比特币的UTXO一样，Input和Output都可以有多个，这样的特点使得NFT在跨链的过程中，可以同时完成一些扩展功能，例如NFT的拆分和合并。</p>

<p>一直一来，NFT都比FT有用更多的操作种类，例如在游戏中，作为道具的NFT要求可拆解、可合成、可升级等，为此扩展出了很多NFT标准，例如ERC721, ERC1155, ERC721X等。标准越多，越难被广泛使用。</p>

<p>如果其中的一些通用需求可以在跨链同时实现，可以有效地减少标准的数量和冗余度，一定程度上更有利于实现一个统一的标准。</p>

<p>##III. 兼容其他跨链设施</p>

<p>因为NFT对可识别性的高要求，使得在跨链时，使用不同跨链设施可能会造成意想不到的后果。而Fungible Token则只要保证价值对称、资产安全即可。</p>

<p>可以想象以下场景：</p>

<blockquote>
  <p>nft(A, X, 1) 表示在A链上、合约X中标识为1的NFT</p>
</blockquote>

<p>Alice在跨链桥M中，将nft(A, X, 1) 变为 nft(B, Y, 2) ；又通过跨链桥N，将nft(B, Y, 2) 变为 nft(C, Z, 3)。之后，当Alice想继续使用跨链桥M将C链上的nft 跨链去 A链的话，跨链桥M会将 nft(C, Z, 3) 识别为新的token，很可能在跨回A链时，将不再是nft(A, X, 1)，而是nft(A, X, 5). NFT就丢失了自己的可识别性，或者是用户就丢失了自己的资产。</p>

<p>为了尽可能减少丢失NFT可识别性对用户造成的潜在资产损失，用户可以获取到Bridge Core上某个NFT当前的UNFO，之后，用户先使用其他跨链设施将NFT跨到UNFO中type记录的对应链之后，再使用Bridge Core 进行后续的跨链操作。</p>

<p>这样，至少在当前系统内，NFT可保证可识别性不被破坏。</p>

<p>在补充章节IV中，我们还将探索其他的兼容方案，例如NFT解析模块。</p>

<h2 id="iv-补充讨论-nft解析模块">IV. 补充讨论： NFT解析模块</h2>

<p>为了方便的标记一个物品或者一个资产，我们会用一个唯一的标识来标记它，不同的物品具有不同的标识。我们先拿物理空间里面的物品举例，在理想情况下，所有的物品都应该在同一个时空里面，这样大家都能观察的到，并且方便做区分和标识。但是现实情况是，不同的物品可能存在于不同的时空里面，并且观察者也不一定能看到每一个物品。同样的情况，在虚拟资产世界，因为存在不同的账本或称区块链网络(简称域)，不同的物品在同一个域里面因为有不同的标识，可以容易的区分和定位，但是该域里面的观察者无法识别和解析来自外部域的物品标识。</p>

<p>目前现有的很多通证标准的设计，都主要是针对域内资产进行标识设计，没有将不同域内的资产复用考虑进来，这样导致在对非同质资产进行复用时，单独的Token ID无法标识唯一的资产，还需要带上很多域信息，实现起来十分复杂。</p>

<p>跨链技术可以极大的帮助通证在更广泛的区块链网络中实现互联互通，但是同时，也给开发者和用户带来了一些认知和使用门槛，其中就包括通证可识别性的问题。</p>

<p>因为目前的通证标准，例如ERC20或ERC721，只记录的其在某个特定链上的所有权信息，没有考虑到通证有可能会分布在两个区块链网络。当通证同时分布在两个区块链网络时，我们需要一套识别和解析系统帮助用户和通证应用来解析和查询当前的通证状态。当我们给出一个NFT的Token ID时，我们无法确定它目前所在区块链网络是哪个，其所有者是谁，因为当NFT发生跨链转移后，在其中一个区块链网络上该通证处于活跃状态，而其他则处于不可用状态，比如锁定状态。在没有通证解析系统的情况下，链外操作无法确定该NFT在哪条链上时处于活跃状态。</p>

<p>跨链环境下，Token面临的识别性和解析问题，需要新的解决方案和标准来解决。因此我们引入一个基于通证跨链证明的解析系统来解决通证跨链时的定位和解析需求，通过通证解析系统和域内唯一标识，我们可以存在与不同域的通证之间的关联关系映射起来，并标识他们之间的相同与不同。</p>

<h3 id="a-设计思路">A. 设计思路</h3>

<p>通证解析模块是NFT cross-chain协议内嵌的一个模块，用于在 <em>Issuing chain</em> 或者其连接的中继链上记录和解析当前通证在中继链范围内的全局状态，并规范化处理成解析格式的方式，来为跨链网络提供通证解析查询和证明服务。</p>

<h4 id="其他跨链共享数据">其他跨链共享数据</h4>

<p>目前通证标准主要的设计是针对所有权信息进行记录，但是并没有对通证的跨链转账，使用权，类型，生产商等信息进行记录，使得通证合约对通证的描述并不全面，也没有提供可扩展的方法来增加其他的信息。</p>

<p>设计通证解析系统的一个额外好处是，因为可以把中继链看做一个共享的模块(共享存储和共享运行时SPREE)。我们引入Token解析合约(脚本)来记录和更新Token的协议、跨链、权利和其他信息。</p>

<p>对于Polkadot架构，可以通过接入SPREE模块，在解析合约内定义约束条件，例如全局的通证总量，发行规则，并部署至SPREE模块，可以实现中继网络管辖范围的验证和可信互操作。</p>

<h3 id="b-通证解析查询消息规范">B. 通证解析查询消息规范</h3>

<p>更多关于SPREE模块的介绍，参考 https://wiki.polkadot.network/en/latest/polkadot/learn/spree</p>

<h3 id="c-通证跨链消息收集">C. 通证跨链消息收集</h3>

<p>当我们讨论跨链时，一般需要分成两种情况：</p>

<h4 id="c-i-cross-parachain同构区块链平行链">C-I. Cross parachain(同构区块链/平行链)</h4>

<p>当在平行链之间进行跨链时，例如在Polkadot网络中，因为有共享安全，ICMP等设计，因此将通证解析系统放在中继链上时最合适的，因为通证跨平行链的消息会流经中继链，中继链可以通过在消息中继模块之外，嵌入一个收集模块，将通证跨链消息规范化统一收集之后，提供给通证解析服务。</p>

<h4 id="c--ii-cross-major-chain-异构链eg-ethereum--bitocin-ethereum-tron-ethereum--polkadot">C -II. Cross major chain (异构链，e.g Ethereum &lt;–&gt; Bitocin, Ethereum &lt;–&gt;TRON, Ethereum &lt;–&gt; Polkadot)</h4>

<p>在这种跨链模式下，通证跨链一般通过跨链转接桥的方案进行跨链，例如ACCS(HTLCs), XClaim, Parity Bridge(Mainet/Sidechain)。跨链消息及相关证明并未流经通证解析服务所在的中继链，而是通过设计收集人激励机制，通过收集人主动收集这些通证跨链证明。从这个角度上将，通证解析服务的链设计成中继链没有优势。</p>

<p>但是通证解析系统设计在中继链的一个<a href="https://github.com/darwinia-network/rfcs/issues/15">可能的好处</a>是，可以在跨链消息收集协议规范化之后，外部的通证跨链转接桥协议可以通过嵌入通证解析系统收集协议的方式，支持通证解析系统，以达到更好的可靠性和完整性和解析性。</p>

<h5 id="c-iii-异构链跨链转接桥解决方案xclaim的集成">C-III. 异构链跨链转接桥解决方案XClaim的集成</h5>

<p>对于基于XClaim技术搭建的跨链转接桥，其Token的跨链是通过在对手链上构建超额抵押的对称CBA来实现的。虽然严格意义上讲，CBA不等同于原通证，但是从用户视角看其效果非常接近。</p>

<p>[WIP]对于这类异构链之间跨链通证的支持仍有希望通过通证解析系统来描述和解析其跨链转接桥过程，只需跟中继链和平行链模式的跨链通证类型稍作区分，便可帮助开发者和用户理解其跨链通证(CBA)和原有通证的区别。</p>

<p>因为需要喂价机制，XClaim解决方案比较适合流动性好的同质Token，但对于价格发现低效的NFT来说，就<a href="https://github.com/darwinia-network/rfcs/issues/16">不那么友好</a>了。</p>

<p>NFT的跨链转接桥方案目前缺乏相关的研究，比较务实的方案可能是由Token创建者指定信任账号作为跨链证明提交者，并结合质押以降低风险。这个方案带来一定程度中心化，但目前也没有更好的办法。</p>

<h3 id="d-全局唯一标识">D. 全局唯一标识</h3>

<p>To harmonise existing practice in identifier assignment and resolution, to support resources in implementing community standards and to promote the creation of identifier services.</p>

<p>通证解析系统分配的TOKEN ID将可以作为该Token在跨链网络中的全局Token标识(Base Token ID)。</p>

<p>对于同质Token来说，因为没有通证的索引，只有数量的概念，解析通证ID可以作为全局通证ID。</p>

<p>对于非同质Token来说，将可以使用解析通证ID加上一个Token内索引得到的编码[解析通证ID+Token_Index]作为全局唯一标识。</p>

</div>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Darwinia Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Darwinia Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Request for comments and improvement proposals</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
